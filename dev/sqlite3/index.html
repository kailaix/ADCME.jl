<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introducing ADCME Database and SQL Integration: an Efficient Approach to Simulation Data Management · ADCME</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ADCME logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ADCME</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../tutorial/">Overview</a></li><li><a class="tocitem" href="../videos_and_slides/">Video Lectures and Slides</a></li><li><a class="tocitem" href="../tu_whatis/">What is ADCME? Computational Graph, Automatic Differentiation &amp; TensorFlow</a></li><li><a class="tocitem" href="../tu_basic/">ADCME Basics: Tensor, Type, Operator, Session &amp; Kernel</a></li><li><a class="tocitem" href="../tu_optimization/">PDE Constrained Optimization</a></li><li><a class="tocitem" href="../tu_sparse/">Sparse Linear Algebra</a></li><li><a class="tocitem" href="../tu_fd/">Numerical Scheme in ADCME: Finite Difference Example</a></li><li><a class="tocitem" href="../tu_fem/">Numerical Scheme in ADCME: Finite Element Example</a></li><li><a class="tocitem" href="../tu_inv/">Inverse Modeling with ADCME</a></li><li><a class="tocitem" href="../tu_recipe/">Inverse Modeling Recipe</a></li><li><a class="tocitem" href="../tu_nn/">Combining Neural Networks with Numerical Schemes</a></li><li><a class="tocitem" href="../tu_implicit/">Advanced: Automatic Differentiation for Implicit Operators</a></li><li><a class="tocitem" href="../tu_customop/">Advanced: Custom Operators</a></li><li><a class="tocitem" href="../tu_debug/">Advanced: Debugging and Profiling</a></li><li><a class="tocitem" href="../exercise/">Exercise: Inverse Modeling with ADCME</a></li></ul></li><li><span class="tocitem">Resources</span><ul><li><a class="tocitem" href="../newton_raphson/">Newton Raphson</a></li><li><a class="tocitem" href="../parallel/">Parallel Computing</a></li><li><a class="tocitem" href="../optimizers/">Optimizers</a></li><li><a class="tocitem" href="../optim/">Study on Optimizers</a></li><li><a class="tocitem" href="../ode/">PDE/ODE Solvers</a></li><li><a class="tocitem" href="../global/">Shared Memory Across Kernels</a></li><li><a class="tocitem" href="../julia_customop/">Julia Custom Operators</a></li><li><a class="tocitem" href="../nn/">Neural Networks</a></li><li><a class="tocitem" href="../ot/">Optimal Transport</a></li><li><a class="tocitem" href="../resource_manager/">Resource Manager</a></li><li><a class="tocitem" href="../alphascheme/">Generalized α Scheme</a></li><li><a class="tocitem" href="../factorization/">Direct Methods for Sparse Matrices</a></li><li><a class="tocitem" href="../customopt/">Custom Optimizer</a></li><li><a class="tocitem" href="../options/">Global Options</a></li><li><a class="tocitem" href="../mcmc/">Uncertainty Quantification of Neural Networks in Physics Informed Learning using MCMC</a></li><li><a class="tocitem" href="../mpi/">Distributed Scientific Machine Learning using MPI</a></li><li><a class="tocitem" href="../mpi_benchmark/">MPI Benchmarks</a></li><li><a class="tocitem" href="../multithreading/">Understand the Multi-threading Model</a></li><li><a class="tocitem" href="../rbf/">Radial Basis Functions</a></li><li><a class="tocitem" href="../topopt/">Topological Optimization</a></li><li><a class="tocitem" href="../quadrature/">Numerical Integration</a></li><li class="is-active"><a class="tocitem" href>Introducing ADCME Database and SQL Integration: an Efficient Approach to Simulation Data Management</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Database-Structure"><span>Database Structure</span></a></li><li><a class="tocitem" href="#Commonly-Used-Operations"><span>Commonly Used Operations</span></a></li><li><a class="tocitem" href="#Next-Steps"><span>Next Steps</span></a></li></ul></li><li><a class="tocitem" href="../hessian/">The Mathematical Structure of DNN Hessians</a></li><li><a class="tocitem" href="../plotly/">Visualization with Plotly</a></li></ul></li><li><span class="tocitem">Physics Informed Machine Learning</span><ul><li><a class="tocitem" href="../fdtd/">Finite-difference Time-domain for Electromagnetics and Seismic Inversion</a></li></ul></li><li><span class="tocitem">Deep Learning Schemes</span><ul><li><a class="tocitem" href="../vae/">Variational Autoencoder</a></li><li><a class="tocitem" href="../flow/">Normalizing Flows</a></li><li><a class="tocitem" href="../convnet/">Convolutional Neural Network</a></li><li><a class="tocitem" href="../bnn/">Bayesian Neural Networks</a></li><li><a class="tocitem" href="../reinforcement_learning/">Reinforcement Learning Basics: Q-learning and SARSA</a></li></ul></li><li><span class="tocitem">Developer Guide</span><ul><li><a class="tocitem" href="../designpattern/">Design Pattern</a></li><li><a class="tocitem" href="../toolchain/">Built-in Toolchain for Third-party Libraries</a></li><li><a class="tocitem" href="../installmpi/">Configure MPI for Distributed Computing</a></li><li><a class="tocitem" href="../windows_installation/">Install ADCME on Windows</a></li><li><a class="tocitem" href="../docker/">Install ADCME Docker Image</a></li></ul></li><li><span class="tocitem">Applications</span><ul><li><a class="tocitem" href="../apps/">Overview</a></li><li><a class="tocitem" href="../apps_ana/">Adversarial Numerical Analysis</a></li><li><a class="tocitem" href="../apps_levy/">Calibrating Multivariate Lévy Processes with Neural Networks</a></li><li><a class="tocitem" href="../apps_constitutive_law/">Learning Constitutive Relations from Indirect Observations Using Deep Neural Networks</a></li><li><a class="tocitem" href="../apps_ad/">Intelligent Automatic Differentiation</a></li><li><a class="tocitem" href="../apps_adseismic/">General Seismic Inversion using Automatic Differentiation</a></li><li><a class="tocitem" href="../apps_nnfem/">Symmetric Positive Definite Neural Networks (SPD-NN)</a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Resources</a></li><li class="is-active"><a href>Introducing ADCME Database and SQL Integration: an Efficient Approach to Simulation Data Management</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introducing ADCME Database and SQL Integration: an Efficient Approach to Simulation Data Management</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kailaix/ADCME.jl/blob/master/docs/src/sqlite3.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Introducing-ADCME-Database-and-SQL-Integration:-an-Efficient-Approach-to-Simulation-Data-Management"><a class="docs-heading-anchor" href="#Introducing-ADCME-Database-and-SQL-Integration:-an-Efficient-Approach-to-Simulation-Data-Management">Introducing ADCME Database and SQL Integration: an Efficient Approach to Simulation Data Management</a><a id="Introducing-ADCME-Database-and-SQL-Integration:-an-Efficient-Approach-to-Simulation-Data-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Introducing-ADCME-Database-and-SQL-Integration:-an-Efficient-Approach-to-Simulation-Data-Management" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>If you have a massive number of simulations and results from different simulation parameters, to facilitate the data analysis and improve reproducibility, database and  Structured Query Language (SQL) are convenient and powerful ways for data management. </p><p>Database allows simulation parameters and results to be stored in a permanent storage, and  records can be inserted, queried, updated, and deleted as we proceed in our research. Specifically, databases are usually designed in a way that we can concurrently read and write in a transactional manner, which ensures that the reads are writes are done correctly even in the case of data conflicts. This characteristic is very useful for parallel simulations. Another important feature of databases is &quot;indexing&quot;. By indexing tables, we can manipute tables in a more efficient way. </p><p><img src="https://github.com/ADCMEMarket/ADCMEImages/blob/master/ADCME/sqlite.png?raw=true" alt/></p><p>SQL is a standad language for accessing and manipulating databases. The four main operations in SQLs are: create, insert, update, and delete. More advanced commands include <code>where</code>, <code>groupby</code>, <code>join</code>, etc. In ADCME, we implemented an interface to SQLite, a relational database management system contained in a C library. SQLite provides basic SQL engines, which is compliant to the SQL standard. One particular feature of SQLite is that the database is a single file or in-memory. This simplifies the client and server SQL logic, but bears the limitation of scalability. Nevertheless, SQLite is more than sufficient to store and manipulate our simulation parameters and results (typically a link to the data folder). </p><p>The introduction primarily focuses on some commonly used features of database management in ADCME. </p><h2 id="Database-Structure"><a class="docs-heading-anchor" href="#Database-Structure">Database Structure</a><a id="Database-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Database-Structure" title="Permalink"></a></h2><p>In ADCME, a database is created using <a href="../api/#ADCME.Database"><code>Database</code></a>. There are two types of database:</p><pre><code class="language-julia">db1 = Database() # in-memory 
db2 = Database(&quot;simulation.db&quot;) # file </code></pre><p>If you created a file-based database, whenever you finished operation, you need to <a href="../api/#ADCME.commit-Tuple{Database}"><code>commit</code></a> to the database or <a href="@ref"><code>close</code></a> the database to make the changes effective. </p><pre><code class="language-julia">commit(db2)
close(db2)</code></pre><p>To execute a SQL command in the database, we can use <a href="../api/#ADCME.execute-Tuple{Database,String,Vararg{Any,N} where N}"><code>execute</code></a> command. In the next section, we list some commonly used operations. By default, <code>commit</code> is called after <code>execute</code>. Users can disable this by using </p><pre><code class="language-julia">db1 = Database(commit_after_execute=false) # in-memory 
db2 = Database(&quot;simulation.db&quot;, commit_after_execute=false) # file </code></pre><h2 id="Commonly-Used-Operations"><a class="docs-heading-anchor" href="#Commonly-Used-Operations">Commonly Used Operations</a><a id="Commonly-Used-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Commonly-Used-Operations" title="Permalink"></a></h2><h3 id="Create-a-Database"><a class="docs-heading-anchor" href="#Create-a-Database">Create a Database</a><a id="Create-a-Database-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-Database" title="Permalink"></a></h3><pre><code class="language-julia">execute(db2, &quot;&quot;&quot;
CREATE TABLE simulation_parameters (
    name real primary key,
    dt real,
    h real, 
    result text 
)
&quot;&quot;&quot;)</code></pre><h3 id="Insert-an-Record"><a class="docs-heading-anchor" href="#Insert-an-Record">Insert an Record</a><a id="Insert-an-Record-1"></a><a class="docs-heading-anchor-permalink" href="#Insert-an-Record" title="Permalink"></a></h3><pre><code class="language-julia">execute(db2, &quot;&quot;&quot;
INSERT INTO simulation_parameters VALUES
(&quot;sim1&quot;, 0.1, 0.01, &quot;file1.png&quot;)
&quot;&quot;&quot;)</code></pre><h3 id="Insert-Many-Records"><a class="docs-heading-anchor" href="#Insert-Many-Records">Insert Many Records</a><a id="Insert-Many-Records-1"></a><a class="docs-heading-anchor-permalink" href="#Insert-Many-Records" title="Permalink"></a></h3><pre><code class="language-julia">params = [
    (&quot;sim2&quot;, 0.3, &quot;file2.png&quot;),
    (&quot;sim3&quot;, 0.5, &quot;file3.png&quot;),
    (&quot;sim4&quot;, 0.9, &quot;file4.png&quot;)
]
execute(db2, &quot;&quot;&quot;
INSERT INTO simulation_parameters VALUES
(?, ?, 0.01, ?)
&quot;&quot;&quot;, params)</code></pre><h3 id="Look-Up-Records"><a class="docs-heading-anchor" href="#Look-Up-Records">Look Up Records</a><a id="Look-Up-Records-1"></a><a class="docs-heading-anchor-permalink" href="#Look-Up-Records" title="Permalink"></a></h3><pre><code class="language-julia">c = execute(db2, &quot;&quot;&quot;
SELECT * from simulation_parameters
&quot;&quot;&quot;)
collect(c)</code></pre><p>Expected output:</p><pre><code class="nohighlight">(&quot;sim1&quot;, 0.1, 0.01, &quot;file1.png&quot;)
(&quot;sim2&quot;, 0.3, 0.01, &quot;file2.png&quot;)
(&quot;sim3&quot;, 0.5, 0.01, &quot;file3.png&quot;)
(&quot;sim4&quot;, 0.9, 0.01, &quot;file4.png&quot;)</code></pre><h3 id="Delete-a-Record"><a class="docs-heading-anchor" href="#Delete-a-Record">Delete a Record</a><a id="Delete-a-Record-1"></a><a class="docs-heading-anchor-permalink" href="#Delete-a-Record" title="Permalink"></a></h3><pre><code class="language-julia">execute(db2, &quot;&quot;&quot;
DELETE from simulation_parameters WHERE name LIKE &quot;%3&quot;
&quot;&quot;&quot;)</code></pre><p>Now the records are</p><pre><code class="nohighlight">(&quot;sim1&quot;, 0.1, 0.01, &quot;file1.png&quot;)
(&quot;sim2&quot;, 0.3, 0.01, &quot;file2.png&quot;)
(&quot;sim4&quot;, 0.9, 0.01, &quot;file4.png&quot;)</code></pre><h3 id="Update-a-Record"><a class="docs-heading-anchor" href="#Update-a-Record">Update a Record</a><a id="Update-a-Record-1"></a><a class="docs-heading-anchor-permalink" href="#Update-a-Record" title="Permalink"></a></h3><pre><code class="language-julia">execute(db2, &quot;&quot;&quot;
UPDATE simulation_parameters
SET h = 0.2
WHERE name = &quot;sim4&quot;
&quot;&quot;&quot;)</code></pre><p>Now the records are </p><pre><code class="nohighlight">(&quot;sim1&quot;, 0.1, 0.01, &quot;file1.png&quot;)
(&quot;sim2&quot;, 0.3, 0.01, &quot;file2.png&quot;)
(&quot;sim4&quot;, 0.9, 0.2, &quot;file4.png&quot;)</code></pre><h3 id="Insert-a-Conflict-Record"><a class="docs-heading-anchor" href="#Insert-a-Conflict-Record">Insert a Conflict Record</a><a id="Insert-a-Conflict-Record-1"></a><a class="docs-heading-anchor-permalink" href="#Insert-a-Conflict-Record" title="Permalink"></a></h3><p>Becase we set <code>name</code> as primary key, we cannot insert a record with the same name</p><pre><code class="language-julia">execute(db2, &quot;&quot;&quot;
INSERT INTO simulation_parameters VALUES
(&quot;sim1&quot;, 0.1, 0.1, &quot;file1_2.png&quot;)
&quot;&quot;&quot;)</code></pre><p>We have an error </p><pre><code class="nohighlight">IntegrityError(&#39;UNIQUE constraint failed: simulation_parameters.name&#39;)</code></pre><p>Alternatively, we can do </p><pre><code class="language-julia">execute(db2, &quot;&quot;&quot;
INSERT OR IGNORE INTO simulation_parameters VALUES
(&quot;sim1&quot;, 0.1, 0.1, &quot;file1_2.png&quot;)
&quot;&quot;&quot;)</code></pre><h3 id="Querying-Meta-Data"><a class="docs-heading-anchor" href="#Querying-Meta-Data">Querying Meta Data</a><a id="Querying-Meta-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Querying-Meta-Data" title="Permalink"></a></h3><ul><li>Get all tables in the database</li></ul><pre><code class="language-julia">keys(db2)</code></pre><p>Output:</p><pre><code class="nohighlight">&quot;simulation_parameters&quot;
&quot;sqlite_autoindex_simulation_parameters_1&quot;</code></pre><p>We can see a table that SQLites adds indexes to some fields: <code>sqlite_autoindex_simulation_parameters_1</code>. </p><ul><li>Get column names in the database</li></ul><pre><code class="language-julia">keys(db2, &quot;simulation_parameters&quot;)</code></pre><p>Output:</p><pre><code class="nohighlight">&quot;name&quot;
&quot;dt&quot;
&quot;h&quot;
&quot;result&quot;</code></pre><h3 id="Drop-a-Table"><a class="docs-heading-anchor" href="#Drop-a-Table">Drop a Table</a><a id="Drop-a-Table-1"></a><a class="docs-heading-anchor-permalink" href="#Drop-a-Table" title="Permalink"></a></h3><pre><code class="language-julia">execute(db2, &quot;&quot;&quot;
DROP TABLE simulation_parameters
&quot;&quot;&quot;)</code></pre><h2 id="Next-Steps"><a class="docs-heading-anchor" href="#Next-Steps">Next Steps</a><a id="Next-Steps-1"></a><a class="docs-heading-anchor-permalink" href="#Next-Steps" title="Permalink"></a></h2><p>We introduced some basic usage of ADCME database and SQL integration for simulation data management. We used one common and lightweight database management system, SQLite, for managing data of moderate sizes. Due to SQL&#39;s wide adoption, it is possible to scale the data management system by adopting a full-fledged database, such as MySQL. In this case, developers can overload ADCME functions such as <code>execute</code>, <code>commit</code>, <code>close</code>, <code>keys</code>, etc., so that the top level codes requires little changes. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../quadrature/">« Numerical Integration</a><a class="docs-footer-nextpage" href="../hessian/">The Mathematical Structure of DNN Hessians »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 18 June 2021 05:09">Friday 18 June 2021</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
